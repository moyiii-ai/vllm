Compiling benchmark_cuda.cu ...
Running benchmark...
=== Simultaneous Write Test ===
Write: dev0->dev1 | Size = 1 MB | Bandwidth = 24.4153 GB/s
Write: dev1->dev0 | Size = 1 MB | Bandwidth = 24.4356 GB/s
Write: dev0->dev1 | Size = 8 MB | Bandwidth = 25.091 GB/s
Write: dev1->dev0 | Size = 8 MB | Bandwidth = 25.0959 GB/s
Write: dev0->dev1 | Size = 64 MB | Bandwidth = 25.2105 GB/s
Write: dev1->dev0 | Size = 64 MB | Bandwidth = 25.2141 GB/s
Write: dev0->dev1 | Size = 256 MB | Bandwidth = 25.2266 GB/s
Write: dev1->dev0 | Size = 256 MB | Bandwidth = 25.2274 GB/s

=== Simultaneous Read Test ===
Read: dev0<-dev1 | Size = 1 MB | Bandwidth = 24.4415 GB/s
Read: dev1<-dev0 | Size = 1 MB | Bandwidth = 24.451 GB/s
Read: dev0<-dev1 | Size = 8 MB | Bandwidth = 25.0865 GB/s
Read: dev1<-dev0 | Size = 8 MB | Bandwidth = 25.0934 GB/s
Read: dev0<-dev1 | Size = 64 MB | Bandwidth = 25.2135 GB/s
Read: dev1<-dev0 | Size = 64 MB | Bandwidth = 25.2136 GB/s
Read: dev0<-dev1 | Size = 256 MB | Bandwidth = 25.2265 GB/s
Read: dev1<-dev0 | Size = 256 MB | Bandwidth = 25.2271 GB/s

=== Simulated All-Reduce Scale: Decode ===
per-copy size ≈ 8 KB, iterations = 8192
-- Bidirectional Write --
Write: dev0->dev1 | Size = 0.0078125 MB | Bandwidth = 4.0555 GB/s
Write: dev1->dev0 | Size = 0.0078125 MB | Bandwidth = 4.04545 GB/s
-- Bidirectional Read --
Read: dev0<-dev1 | Size = 0.0078125 MB | Bandwidth = 4.05164 GB/s
Read: dev1<-dev0 | Size = 0.0078125 MB | Bandwidth = 4.07036 GB/s

=== Simulated All-Reduce Scale: Prefill ===
per-copy size ≈ 16 MB, iterations = 64
-- Bidirectional Write --
Write: dev0->dev1 | Size = 16 MB | Bandwidth = 25.1546 GB/s
Write: dev1->dev0 | Size = 16 MB | Bandwidth = 25.1704 GB/s
-- Bidirectional Read --
Read: dev0<-dev1 | Size = 16 MB | Bandwidth = 25.1527 GB/s
Read: dev1<-dev0 | Size = 16 MB | Bandwidth = 25.1708 GB/s
